---
layout: default
title: 谈程序的“通用性”
---


在现实的软件工程中，我经常发现这样的一种现象。本来用很简单的代码就可以解决的问题，却因为设计者对“通用性”，“可维护性”和“可扩展性”的需要，被搞得绕了几道弯，让人琢磨不透。这些人的思维方式是这样的：“将来这段代码可能会被用到更多的场合，所以我现在就考虑到扩展问题。”于是乎，他们在代码中加入了各种各样的“框架结构”，目的是为了在将来有新的需要的时候，代码能够“不加修改”。

我并不否认“通用性”的价值，实际上我写出的程序通用性非常之强。可是很多人所谓的“通用性”，其实达到的是适得其反的效果。


1. 代码需要被“重用”的场合，实际上比你想象的要少

   我发现很多人写程序的时候连“眼前特例”都没做好，就在开始“展望将来”。他们总是设想别人会“重用”这段代码。而实际上，由于他们的设计过于复杂，理解这设计所需的脑力开销，已经高于从头开始的代价。所以大部分人其实根本不会去用他们的代码，自己重新写一个就是了。也有人到后来发现，之前写的那段代码，连自己都看不下去了，恨不得删了重来，就不要谈什么重用了。


1. 修改代码所需要的工作，实际上比你想象的要少

   还有一种情况是，这些被设计来“共享”的代码，其实根本没有被用在很多的地方，所以即使你完全手动的修改它们也花不了很多时间。现在再加上 IDE 技术的发展和各种先进的 refactor 工具，批量的修改代码已经不是特别麻烦的事情。曾经需要在“逻辑层面”上进行的“可维护性”设计，现在有可能只需要在 IDE 里面点几下鼠标就轻松完成。所以在考虑设计一个框架之前，你应该同时考虑到这些因素。


1. “考虑”到通用性，并不等于你就准确地“把握”住了通用性

   很多人考虑到了通用性，却没有准确的看到，到底是哪一个部分将来可能需要修改，所以他们设计的框架经常抓不住关键。当有新的需要出现的时候，才发现原来预期可能变化的部分，其实根本没有变，而原来没有想到的地方却变了。


1. 理解和维护框架性代码的开销

   首先每个程序员为了在这个框架下编写代码，都需要理解这种框架的构造，这带来了学习的开销。一旦发现这框架有设计问题，依赖于它的代码很有可能需要修改，这又带来了修改的开销。所以加入“通用性”之后，其实带来了更多的工作。这种开销能不能得到回报，依赖于很多因素。
