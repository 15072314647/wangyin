---
layout: default
title: Markdown 的一些问题
---

把我之前的博文基本上转换成了 markdown 格式。我发现 markdown 虽然在编辑器里看起来比 HTML 清晰一些，但也有一些不足。

这种格式很像我本科的时候给我爸做的一种“标准化试卷标记语言”（因为我爸是中学英语老师）。当时我写了一个1000来行的 Perl 脚本，可以把这种简单的标记语言转换成美观的 LaTeX 格式文档，并且带有友好的 Tk 图形界面。题目可以包括选择题，填空题，改错题，…… 这种语言的特点是，题目和答案都放在一起。经过处理之后，答案与题目分离，并且被放到答案表里正确的位置上。

比如，选择题的格式是这样：

    $ Our teacher told us that there ______ no end to learning.
       A. was    B. is *        C. has            D. had

每道题开头都是一个 $，正确答案后面加一个 *。在处理的时候这些 $ 都会被变成题目编号，而有 `*` 标记的答案选项，会被放到答案表里面。

最有意思的是改错题。因为改错题是一个英语段落，某些行有错，但每行最多只能有一个错。所以我的设计是，在普通的段落里插入这样的记号：`| correct | incorrect |`。其中 `correct` 和 `incorrect` 都可以是空白，用以表示“插入”与“删除”。最后我会根据这些标记的位置把段落排版，让每行上面最多只有一个错。为了让段落的行看起来均匀，我使用了一种类似 TeX 的动态规划断行算法。这里使用 `|` 是因为这个符号不会在普通的英语文章里出现。

现在回想起来，我那时候做出来的东西就已经相当先进了。跟我的语言相比，markdown 真是小巫见大巫了。有点跑题了，还是回头来看看 markdown 的问题吧。


* Markdown 实际上采用的是类似 Python 和 Haskell 的 layout 语法。

  我已经在一篇[英文博文](http://en.yinwang.org/blog-en/2011/05/08/layout)里提到了 layout 语法的多种问题。因为空格的数量决定了文档的结构，这种文档格式相当的“脆弱”。稍微少打一两个空格，就会出现不可预测的结果。这种现象在“item”内部的代码块最容易出现。因为“item”带来了缩进，所以内部的代码必须比item缩进多4个空格，才能被排到正确的位置。比如我转换博文的时候多次出现以下的情况：

  <img src="http://www.yinwang.org/images/markdown-mistake.png" width="90%">

  这里的问题是，代码里的第一行 `helloworld z = let x = 1` 因为缩进不够，被放到了代码块外面。但是为了准确的缩进所耗费的精力，其实比直接打 `<pre>` 这样的 tag 还要多。


* 特殊字符的选择不合理

  markdown 对特殊字符的使用不大合理。我多次发现文档段落整段的变成斜体，就是因为原来的文档里出现了 `x*y` 这样的表达式。在程序员的世界里，“乘法”显然比“强调”更加频繁。把 \* 用于标记“强调”，实际上把一个非常有用的字符用在了很不频繁的用途。


* 表达力相当有限

  在有些细节上，markdown 并不能表达我想要的格式。比如它不能正确的插入断行 `<br>`。如果你有两块紧接在一起的代码，但你不想把它们连在一起…… 于是你就发现自己加入了越来越多的 HTML。

  这在图片的语法上就更加明显，markdown 引入了 `![alt](image url)` 这样的格式，其实比起 HTML 还要难看和不一致。比如现在它仍然无法表达图片的大小，这是相当重要的信息。所以我觉得 markdown 的语法已经显示出了它的弱点，如果它要表达更复杂的信息，就会变得比 HTML 还要难记，难看。所以对于图片，我觉得还不如直接用 HTML 的 `<img>` 。

所以总的感觉是 markdown 引入了太多的“语法”，以至于稍微复杂一点的信息表达起来还不如 HTML 来的直接。现在就这样先凑合着吧。也许过段时间自己设计一个格式。
